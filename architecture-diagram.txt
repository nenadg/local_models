┌───────────────────────┐
│    TinyLlamaChat      │
│  (Main orchestrator)  │
└───────────┬───────────┘
            │
            │ coordinates
            ▼
┌──────────────────────────────────────────────────┐
│                                                  │
│ ┌────────────────┐    ┌─────────────────────┐    │
│ │   LLM Models   │    │  MCPHandler         │    │
│ │ + Speculative  │    │  (File/Shell output)│    │
│ │   Decoding     │    └─────────────────────┘    │
│ └────────────────┘                               │
│                                                  │
│ ┌────────────────┐    ┌─────────────────────┐    │
│ │ ResponseFilter │    │ EnhancedConfidence  │    │
│ │ (Hallucination)│    │ Metrics (Token      │    │
│ └────────────────┘    │ probabilities)      │    │
│                       └─────────────────────┘    │
│                                                  │
│ ┌────────────────┐    ┌─────────────────────┐    │
│ │ EnhancedHeatmap│    │ QuestionClassifier  │    │
│ │ (Visualization)│    │ (Domain detection)  │    │
│ └────────────────┘    └─────────────────────┘    │
│                                                  │
│ ┌────────────────────────────────────────────┐   │
│ │ ResourceManager (CUDA memory optimization) │   │
│ └────────────────────────────────────────────┘   │
│                                                  │
└──────────────────────────────────────────────────┘
            │
            │ uses for context
            ▼
┌──────────────────────────────────────────────────┐
│                Memory System                     │
│                                                  │
│ ┌────────────────┐    ┌─────────────────────┐    │
│ │ MemoryManager  │    │ VectorStore         │    │
│ │ (Management)   │    │ (FAISS + Fractal    │    │
│ └────────────────┘    │  Embeddings)        │    │
│                       └─────────────────────┘    │
│                                                  │
│ ┌────────────────┐    ┌─────────────────────┐    │
│ │ WeightedMemory │    │ WebKnowledgeEnhancer│    │
│ │ Integrator     │    │ (Internet search    │    │
│ │ (Domain-aware) │    │  augmentation)      │    │
│ └────────────────┘    └─────────────────────┘    │
│                                                  │
│ ┌────────────────────────────────────────────┐   │
│ │ Procedural Knowledge & Command Memory      │   │
│ │ (Specialized information extraction)       │   │
│ └────────────────────────────────────────────┘   │
│                                                  │
└──────────────────────────────────────────────────┘